#!/usr/bin/env python

# N, S1 and S2 are obtained by querying the server

from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes, isPrime

M = bytes_to_long(b"Username: Admin, Access code: CryptoBestCategoryF3")

# (-1)^d (mod N) + 1
# ie the modulus is the signature of -1, incremented by 1
N = 128431866904911992199007653336157138531644735899465555328379125184342266913400631891760891716256926229891077754184337065008597186280941431185284045708618313063813481460133514865716490653878401769946520983929951006006984349881622323548797896317447706464750326911400613598932793881195067831439950878279672568698

# we choose a random message M1
M1 = 3
S1 = 108747293158593602246751918203337252881434099069671681307633221420984967153987605247648446065309743086448523051467956393139333122580369169596820619858075563022543148835313437306984778366194580175237368110181988569381104792003488579745450521988418829758021316456859950949571895384367334935574064238424261541930

# and invert M1:
# M2 = M * M1^-1
# M1 * M2 = M
M2 = M * pow(3, -1, N)
S2 = 35947459364966720991746790584231183493867011601354105327576888047125772849956456952140212730347482096667759959949994784533729436265772401351444075562213589183036459021435332714322366597998435041445960794392382270649434171442406292754435662384392270473896283120311959739591870787650997679719016671635243692627

# S1 * S2 is the signature of M
S = S1 * S2