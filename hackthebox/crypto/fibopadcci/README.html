<!DOCTYPE html>
<!--
==============================================================================
                GitHub HTML Pandoc Template — by Apehex
==============================================================================
Copyright (c) Apehex, 2021, MIT License (MIT).

- https://github.com/apehex/homesick

Forked from "pandoc-goodies" by Tristano Ajmone:

- https://github.com/tajmone/pandoc-goodies

The CSS in this template reuses source code taken from the following projects:

- GitHub Markdown CSS: Copyright © Sindre Sorhus, MIT License (MIT):
  https://github.com/sindresorhus/github-markdown-css

- Primer CSS: Copyright © 2016-2017 GitHub Inc., MIT License (MIT):
  http://primercss.io/

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The MIT License

Copyright (c) Apehex, 2021 (github.com/apehex/homesick)
Copyright (c) Tristano Ajmone, 2017-2020 (github.com/tajmone/pandoc-goodies)
Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com)
Copyright (c) 2017 GitHub Inc.

"GitHub Pandoc HTML5 Template" is Copyright (c) Tristano Ajmone, 2017-2020,
released under the MIT License (MIT); it contains readaptations of substantial
portions of the following third party softwares:

(1) "GitHub Markdown CSS", Copyright (c) Sindre Sorhus, MIT License (MIT).
(2) "Primer CSS", Copyright (c) 2016 GitHub Inc., MIT License (MIT).

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
==============================================================================-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Fibopadcci</title>
  <style type="text/css">
@charset "UTF-8";.markdown-body{-webkit-print-color-adjust: exact;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%;color: #24292e;font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji","Segoe UI Symbol";font-size: 16px;line-height: 1.5;word-wrap: break-word;box-sizing: border-box;min-width: 200px;max-width: 96%;margin: 0 auto;padding: 45px}.markdown-body a{color: #0366d6;background-color: transparent;text-decoration: none;-webkit-text-decoration-skip: objects}.markdown-body a:active,.markdown-body a:hover{outline-width: 0}.markdown-body a:hover{text-decoration: underline}.markdown-body a:not([href]){color: inherit;text-decoration: none}.markdown-body strong{font-weight: 600}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top: 24px;margin-bottom: 16px;font-weight: 600;line-height: 1.25}.markdown-body h1{font-size: 2em;margin: 0.67em 0;padding-bottom: 0.3em;border-bottom: 1px solid #eaecef}.markdown-body h2{padding-bottom: 0.3em;font-size: 1.5em;border-bottom: 1px solid #eaecef}.markdown-body h3{font-size: 1.25em}.markdown-body h4{font-size: 1em}.markdown-body h5{font-size: 0.875em}.markdown-body h6{font-size: 0.85em;color: #6a737d}.markdown-body img{border-style: none}.markdown-body svg:not(:root){overflow: hidden}.markdown-body hr{box-sizing: content-box;height: 0.25em;margin: 24px 0;padding: 0;overflow: hidden;background-color: #e1e4e8;border: 0}.markdown-body hr::before{display: table;content: ""}.markdown-body hr::after{display: table;clear: both;content: ""}.markdown-body input{margin: 0;overflow: visible;font: inherit;font-family: inherit;font-size: inherit;line-height: inherit}.markdown-body [type="checkbox"]{box-sizing: border-box;padding: 0}.markdown-body *{box-sizing: border-box}.markdown-body blockquote{margin: 0}.markdown-body ol,.markdown-body ul{padding-left: 2em}.markdown-body ol ol,.markdown-body ul ol{list-style-type: lower-roman}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top: 0;margin-bottom: 0}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type: lower-alpha}.markdown-body li > p{margin-top: 16px}.markdown-body li li{margin-top: 0.25em}.markdown-body dd{margin-left: 0}.markdown-body dl{padding: 0}.markdown-body dl dt{padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: 600}.markdown-body dl dd{padding: 0 16px;margin-bottom: 16px}.markdown-body code{font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier,monospace}.markdown-body pre{font: 12px SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier,monospace;word-wrap: normal}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top: 0;margin-bottom: 16px}.markdown-body blockquote{padding: 0 1em;color: #6a737d;border-left: 0.25em solid #dfe2e5}.markdown-body blockquote > :first-child{margin-top: 0}.markdown-body blockquote > :last-child{margin-bottom: 0}.markdown-body table{display: block;width: 100%;overflow: auto;border-spacing: 0;border-collapse: collapse}.markdown-body table th{font-weight: 600}.markdown-body table td,.markdown-body table th{padding: 6px 13px;border: 1px solid #dfe2e5}.markdown-body table tr{background-color: #fff;border-top: 1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color: #f6f8fa}.markdown-body img{max-width: 100%;box-sizing: content-box;background-color: #fff}.markdown-body code{padding: 0.2em 0;margin: 0;font-size: 85%;background-color: rgba(27, 31, 35, 0.05);border-radius: 3px}.markdown-body code::after,.markdown-body code::before{letter-spacing: -0.2em;content: " "}.markdown-body pre > code{padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: 0 0;border: 0}.markdown-body .highlight{margin-bottom: 16px}.markdown-body .highlight pre{margin-bottom: 0;word-break: normal}.markdown-body .highlight pre,.markdown-body pre{padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f6f8fa;border-radius: 3px}.markdown-body pre code{display: inline;max-width: auto;padding: 0;margin: 0;overflow: visible;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0}.markdown-body pre code::after,.markdown-body pre code::before{content: normal}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color: #005cc5;border-color: #005cc5}.markdown-body kbd{box-shadow: inset 0 -1px 0 #959da5;display: inline-block;padding: 3px 5px;font: 11px/10px SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier,monospace;color: #444d56;vertical-align: middle;background-color: #fcfcfc;border: 1px solid #c6cbd1;border-bottom-color: #959da5;border-radius: 3px;box-shadow: inset 0 -1px 0 #959da5}.markdown-body :checked .radio-label{position: relative;z-index: 1;border-color: #0366d6}.markdown-body .task-list-item{list-style-type: none}.markdown-body .task-list-item .task-list-item{margin-top: 3px}.markdown-body .task-list-item input{margin: 0 0.2em 0.25em -1.6em;vertical-align: middle}.markdown-body::before{display: table;content: ""}.markdown-body::after{display: table;clear: both;content: ""}.markdown-body > :first-child{margin-top: 0 !important}.markdown-body > :last-child{margin-bottom: 0 !important}.Alert,.Error,.Note,.Success,.Warning{padding: 11px;margin-bottom: 24px;border-style: solid;border-width: 1px;border-radius: 4px}.Alert p,.Error p,.Note p,.Success p,.Warning p{margin-top: 0}.Alert p:last-child,.Error p:last-child,.Note p:last-child,.Success p:last-child,.Warning p:last-child{margin-bottom: 0}.Alert{color: #246;background-color: #e2eef9;border-color: #bac6d3}.Warning{color: #4c4a42;background-color: #fff9ea;border-color: #dfd8c2}.Error{color: #911;background-color: #fcdede;border-color: #d2b2b2}.Success{color: #22662c;background-color: #e2f9e5;border-color: #bad3be}.Note{color: #2f363d;background-color: #f6f8fa;border-color: #d5d8da}.Alert h1,.Alert h2,.Alert h3,.Alert h4,.Alert h5,.Alert h6{color: #246;margin-bottom: 0}.Warning h1,.Warning h2,.Warning h3,.Warning h4,.Warning h5,.Warning h6{color: #4c4a42;margin-bottom: 0}.Error h1,.Error h2,.Error h3,.Error h4,.Error h5,.Error h6{color: #911;margin-bottom: 0}.Success h1,.Success h2,.Success h3,.Success h4,.Success h5,.Success h6{color: #22662c;margin-bottom: 0}.Note h1,.Note h2,.Note h3,.Note h4,.Note h5,.Note h6{color: #2f363d;margin-bottom: 0}.Alert h1:first-child,.Alert h2:first-child,.Alert h3:first-child,.Alert h4:first-child,.Alert h5:first-child,.Alert h6:first-child,.Error h1:first-child,.Error h2:first-child,.Error h3:first-child,.Error h4:first-child,.Error h5:first-child,.Error h6:first-child,.Note h1:first-child,.Note h2:first-child,.Note h3:first-child,.Note h4:first-child,.Note h5:first-child,.Note h6:first-child,.Success h1:first-child,.Success h2:first-child,.Success h3:first-child,.Success h4:first-child,.Success h5:first-child,.Success h6:first-child,.Warning h1:first-child,.Warning h2:first-child,.Warning h3:first-child,.Warning h4:first-child,.Warning h5:first-child,.Warning h6:first-child{margin-top: 0}h1.title,p.subtitle{text-align: center}h1.title.followed-by-subtitle{margin-bottom: 0}p.subtitle{font-size: 1.5em;font-weight: 600;line-height: 1.25;margin-top: 0;margin-bottom: 16px;padding-bottom: 0.3em}div.line-block{white-space: pre-line}
  </style>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<article class="markdown-body">
<header>
<h1 class="title">Fibopadcci</h1>
</header>
<blockquote>
<p>While investigating the reported insider risk, we managed to retrieve
the source code for a suspicious server. However, we still can’t figure
out how to decrypt the admin’s message. Can you help us?</p>
</blockquote>
<blockquote>
<p>Author: <strong><a
href="https://app.hackthebox.eu/users/219091">willwam845</a></strong></p>
</blockquote>
<h2 id="interacting-with-the-server">Interacting with the server</h2>
<p>The server has 2 modes:</p>
<pre><code>-------------------------
| Menu                  |
-------------------------
|[0] Encrypt flag.      |
|[1] Send me a message! |
-------------------------</code></pre>
<p>Mode 0 returns:</p>
<pre><code>encrypted_flag: 47b756c88a143410ed2ba29e94689b89fcba3706f14b33fbbf65be59b78c4a5845fc5c2a1bbb66a21f0b3b23dbeed815
a: b1d755cd8fff461835974451f7528fd3
b: dcfefc222548071dc06db50c3b6e1e18</code></pre>
<p>Each time you request an encrypted flag the result changes. Supposing
that the flag and key are constant, the change comes from the
randomization of the IV a &amp; b.</p>
<p>In return, the mode 1 allows to send a ciphertext with its IV. The
server only says whether the padding is correct after decryption.</p>
<h2 id="the-encryption-scheme">The encryption scheme</h2>
<h3 id="aes-cbc">AES CBC</h3>
<p>AES is used in block mode:</p>
<ul>
<li>the block length is 16 bytes</li>
<li>the data is padded until it reaches a length multiple of 16</li>
<li>then the data is chunked in blocks</li>
</ul>
<p>More precisely, it is a variant of the CBC mode, with a propagation
from one block to the next.</p>
<h3 id="particularities">Particularities</h3>
<p>Reading the server side code gives us the exact algorithm:</p>
<p><img src="maths/equations/cbc.png" /></p>
<p>The encryption scheme has a few particularities:</p>
<ul>
<li>each plaintext block is xorred twice:
<ul>
<li>once with the previous plaintext block</li>
<li>once with the previous encrypted block</li>
</ul></li>
<li>the padding is an excerpt from the Fibonacci sequence</li>
<li>the decryption is made with an unrelated IV</li>
</ul>
<p>I found that being rigorous with notations helps a lot with
confusion. The details of my notations are at the <a
href="#annex-notations">end of the document</a>.</p>
<p>The special padding will be called “fibopadcci” and noted <img
src="maths/constants/fibopadcci-i.png" alt="P_i" />, for i bytes of
padding:</p>
<p><img src="maths/constants/fibopadcci-5.png" /></p>
<h3 id="properties">Properties</h3>
<p>Because of the chaining, xorring each cipher block with a constant δ
impacts all the plaintext with the same constant:</p>
<p><img src="maths/equations/cbc-linearity.png" /></p>
<p>This can be easily demonstrated by a mathematical induction, thanks
to the former equation set.</p>
<p>And it means that we can modify the decrypted plaintext without
knowing the key!</p>
<h2 id="the-padding-oracle">The padding oracle</h2>
<h3 id="padding-incorrect">Padding incorrect</h3>
<p>Suppose we want to alter the cipher and send it to the server.</p>
<p>Selecting the mode 0, we receive:</p>
<ul>
<li>a plaintext IV <img src="maths/variables/plaintext-iv.png"
alt="a" /></li>
<li>a ciphertext IV <img src="maths/variables/ciphertext-iv.png"
alt="b" /></li>
<li>the flag <img src="maths/equations/c-definition.png" alt="c" />:
<ul>
<li>padded with bytes from the Fibonacci sequence</li>
<li>encrypted with an unknown key <img src="maths/constants/key.png"
alt="K_s" /></li>
</ul></li>
</ul>
<p>And we send:</p>
<ul>
<li>a new ciphertext IV <img src="maths/equations/b-xor-delta.png"
alt="b+δ" /></li>
<li>and a new ciphertext <img src="maths/equations/c-xor-delta.png"
alt="c+δ" /></li>
</ul>
<p>The server then performs the decryption:</p>
<p><img src="maths/equations/fixed-plaintext-iv.png" /></p>
<p>And it fails with “padding incorrect”. For two reasons:</p>
<ul>
<li><img src="maths/equations/c-xor-delta.png" alt="c+δ" /> is mostly
random, there is no reason for it to end with the right padding</li>
<li>the server actually performs the decryption with an unrelated
plaintext IV, <img src="maths/constants/plaintext-iv.png"
alt="A_s" /></li>
</ul>
<p>Both problems can be solved with a <del>bit</del> lot of coding.</p>
<h3 id="adjusting-to-the-fixed-iv">Adjusting to the fixed IV</h3>
<p>The server performs the decryption with a fixed value for a, <img
src="maths/constants/plaintext-iv.png" alt="A_s" />:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="st">b&#39;HTB{th3_s3crt_A}&#39;</span> <span class="co"># My secret A! Only admins know it, and plus, other people won&#39;t be able to work out my key anyway!</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a.<span class="bu">hex</span>())</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;4854427b7468335f73336372745f417d&#39;</span></span></code></pre></div>
<p>This limits the alteration vector to a single value:</p>
<p><img src="maths/equations/calculating-delta.png" /></p>
<p>This way the server actually decrypts the altered ciphertext to:</p>
<p><img src="maths/equations/cbc-1-linearity.png" /></p>
<h3 id="success">Success!</h3>
<p>Still there is no guarantee that <img
src="maths/equations/altered-plaintext.png" alt="F_s+δ" /> ends with a
fibopadcci.</p>
<p>The server randomizes <img src="maths/variables/plaintext-iv.png"
alt="a" /> and <img src="maths/variables/ciphertext-iv.png" alt="b" />
each time we request the mode 0.</p>
<p>This makes the result of the decryption random as well: with enough
tries, the last few bytes of the decrypted vector will be valid
fibopadcci.</p>
<p>On average, “enough” a probability of <code>(1 / 256^i)</code> for i
matching bytes of fibopadcci:</p>
<ul>
<li><code>1 / 256</code> for 1 bytes</li>
<li><code>1 / 65536</code> for 2 bytes</li>
<li>etc</li>
</ul>
<p>When the server responds with “message successfully sent”,
realistically only the last byte matches.</p>
<p>And the fibopadcci of length 1 byte is:</p>
<p><img src="maths/constants/fibopadcci-1.png" /></p>
<h3 id="decryption-of-the-last-byte">Decryption of the last byte</h3>
<p>Knowing <img src="maths/constants/fibopadcci-1.png" alt="P_1" /> is
final result of the decryption, we can infer the last byte:</p>
<p><img src="maths/equations/decrypt-last-byte-flag.png" /></p>
<p>Finally! This gives us the last byte of the last block.</p>
<p>Yup, we knew this all along… Which is actually very good news, since
I was wondering the whole time if my ramblings made any sense.</p>
<p>Also, since that last byte is not padding:</p>
<blockquote>
<p>the flag is -at least- 16 bytes longs</p>
</blockquote>
<h3 id="iteration">Iteration</h3>
<p>That’s when the attack cranks up!</p>
<h2 id="the-implementation">The implementation</h2>
<p>I felt clever until I hit the socket implementation ^^</p>
<h2 id="annex-notations">Annex: notations</h2>
<h3 id="syntax">Syntax</h3>
<ul>
<li>the first numeric subscript index is the block index: <img
src="maths/constants/flag-block-n.png" alt="F_s,n" /></li>
<li>the second numeric subscript index is the bytes index, in the block:
<img src="maths/constants/flag-block-n-byte-i.png" alt="F_s,n,i" /></li>
</ul>
<h3 id="naming">Naming</h3>
<h4 id="constants">Constants</h4>
<p>The constants are written in uppercase:</p>
<ul>
<li>the secret plaintext <strong>flag</strong> is <img
src="maths/constants/flag.png" alt="F_s" /></li>
<li>the secret plaintext IV is <img
src="maths/constants/plaintext-iv.png" alt="A_s" /></li>
<li>the secret key is <img src="maths/constants/key.png"
alt="K_s" /></li>
<li>the number of blocks in the flag is <img
src="maths/constants/flag-length.png" alt="N" /></li>
<li>the special padding:
<ul>
<li>is called “fibopadcci”</li>
<li><img src="maths/constants/fibopadcci-i.png" alt="P_i" /> denotes a
padding of i bytes</li>
<li>no distinction is made between:
<ul>
<li>a full block length random vector ending with i padding bytes</li>
<li>and a vector of only i padding bytes</li>
</ul></li>
</ul></li>
</ul>
<h4 id="variables">Variables</h4>
<p>In contrast, all the variables are written in lowercase:</p>
<ul>
<li>any plaintext IV is either <img
src="maths/variables/plaintext-iv.png" alt="a" /> or <img
src="maths/variables/plaintext-0.png" alt="p_0" /></li>
<li>any ciphertext IV is either <img
src="maths/variables/ciphertext-iv.png" alt="b" /> or <img
src="maths/variables/ciphertext-0.png" alt="c_0" /></li>
<li>any plaintext is <img src="maths/variables/plaintext.png"
alt="p" /></li>
<li>any ciphertext is <img src="maths/variables/ciphertext.png"
alt="c" /></li>
<li>any block index is <img src="maths/variables/block-index.png"
alt="n" />: <img src="maths/constants/flag-block-n.png"
alt="F_s,n" /></li>
<li>any byte index is <img src="maths/variables/byte-index.png"
alt="i" />: <img src="maths/constants/flag-block-n-byte-i.png"
alt="F_s,n,i" /></li>
<li>any block mask is <img src="maths/variables/block-mask.png"
alt="δ" /> ; it can either represent:
<ul>
<li>a single block mask</li>
<li>or a mask of multiple blocks, with the same pattern repeated on
each</li>
<li>depending on the size of the vector it is xorred with</li>
</ul></li>
<li>any ignored / random byte in hexadecimal format is
<code>..</code></li>
</ul>
<h4 id="functions">Functions</h4>
<p>The functions are written in uppercase:</p>
<ul>
<li>the XOR operation is <img src="maths/functions/xor.png"
alt="XOR" /></li>
<li>the XOR inverse operation is also XOR <img
src="maths/functions/xor.png" alt="XOR" /></li>
<li>the AES encryption function is <img src="maths/functions/aes.png"
alt="E" /></li>
<li>the AES decryption function is <img src="maths/functions/aes-1.png"
alt="E-1" /></li>
<li>the overall CBC encryption scheme is <img
src="maths/functions/cbc.png" alt="C" /></li>
<li>the overall CBC decryption scheme is <img
src="maths/functions/cbc-1.png" alt="C-1" /></li>
</ul>
</article>
</body>
</html>
